---
layout: post
title: 합의 알고리즘
subtitle:
categories: blockchain
banner:
  image: https://github.com/dbdpfls/dbdpfls.github.io/assets/103565462/d3fdaaf5-e56c-4cf6-b0d1-d3c538820d23
tags: [blockchain]
---

## 합의 알고리즘

합의 알고리즘은 블록체인 상에서의 의사결정 방식을 말합니다.

합의 알고리즘은 아래의 두 속성을 만족해야 합니다.

- **Safety** : 시스템에 나쁜 일이 발생하지 않는다는 의미로 문제없는 노드는 잘못된 합의를 하지 않는다는 뜻입니다.
- **Liveness** : 시스템은 항상 살아있어야 한다는 의미로 문제없는 노드는 반드시 합의를 한다는 뜻입니다.

---

- Liveness over Safety : 잘못된 합의가 이루어질 수 있지만 어떻게든 합의를 한다는 의미입니다.
- Safety over Liveness : 잘못될 가능성이 있다면 블록을 만들지 않는다는 의미입니다.

### 비잔틴 장애 허용(BFT; Byzantine Fault Tolerance)

#### 비잔틴 장군 문제

비잔틴 장군 문제는 네트워크 참여자 중에서 악의적인 노드가 있을 때 어떻게 해야 합의를 이룰 수 있는지에 대한 내용입니다.
![비잔틴1](https://github.com/dbdpfls/dbdpfls.github.io/assets/103565462/4143523a-d17c-435e-8c2f-5f3e2999aa31)
서로 멀리 떨어져 있는 장군들이 적군의 성을 함락시켜야 하는데 모든 장군이 동시에 공격을 해야 성을 함락시킬 수 있습니다.
만약 정보 전달 시에 정보가 전달되지 않거나 잘못된 정보가 전달되는 경우가 생길수도 있고, 장군 중에 배신자가 있을 수도 있습니다. 이런 경우에는 성을 함락시킬 수 없습니다.
![비잔틴](https://github.com/dbdpfls/dbdpfls.github.io/assets/103565462/826399b9-4fc3-4032-b9b0-cdfb8d4923f7)

#### 비잔틴 장애 허용

비잔틴 장애 허용은 시스템에 문제가 발생하더라도 전체의 3분의 1이 넘지 않으면 시스템을 정상 작동하도록 하는 것입니다. 즉, **3분의 2 이상의 신뢰할 수 있는 노드가 있으면 합의에 달성**할 수 있다는 의미입니다.

- **BFT(Byzantine Fault Tolerance)와 CFT(Crash Fault Tolerance)**
  BFT는 악의적인 노드에 의한 문제상황까지 해결하는 방식이고 CFT는 시스템에서 노드에 문제가 생기더라고 나머지 시스템에서 작동하는 것입니다.
- **PBFT(Practical Byzantine Fault Tolerance)**
  기존 BFT 알고리즘은 동기식 네트워크에서만 합의가 가능했는데 PBFT는 비동기 시스템에서도 합의를 이룰 수 있도록 개발된 알고리즘입니다.
- **Tendermint**
  Tendermint는 DPoS개념과 PBFT 개념을 섞어 공개 및 비공개 블록체인에서 사용할 수 있도록 개량한 합의 알고리즘입니다.

### 합의 알고리즘 종류

| 합의 방식            | 설명                                                                                                      | 장점                                                     | 단점                                                       |
| -------------------- | :-------------------------------------------------------------------------------------------------------- | -------------------------------------------------------- | ---------------------------------------------------------- |
| 작업증명<br>PoW      | 각 노드의 연산 능력을 증명하여 새 블록을 생성하는 방식                                                    | 오랫동안 검증된 방식                                     | - 51% 공격 완결성 문제<br>- 느린 트랜잭션<br>- 에너지 낭비 |
| 지분증명<br>PoS      | 소유 지분 양에 따라 블록 생성 권한을 부여 받을 확률을 높인 방식                                           | - 51% 공격 내성<br>- 빠른 트랜잭션<br>- 적은 에너지 낭비 | 완결성 문제 검증 부족                                      |
| 위임지분증명<br>DPoS | 블록 생성 권한을 소스 대리인에게 위임하는 방식                                                            | - 빠른 트랜잭션<br>- 적은 에너지 낭비                    | - 완전성 문제 검증 부족<br>- 탈중앙성 부족<br>- 보안 취약  |
| 경과시간증명<br>PoET | 작업증명(PoW) 방식의 경쟁적 해싱 연산으로 낭비되는 에너지를 줄이면서 유사한 수준의 보안성을 보장하는 방식 | - 검증된 방법의 개선<br>- 적은 에너지 낭비               | 특정 SW 종속                                               |
